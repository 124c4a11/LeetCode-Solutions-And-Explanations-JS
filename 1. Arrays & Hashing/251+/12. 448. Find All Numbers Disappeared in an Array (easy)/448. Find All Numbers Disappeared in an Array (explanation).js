/**
 * @param {number[]} nums
 * @return {number[]}
 * 
 * findDisappearedNumbers находит все
 * отсутствующие числа в диапазоне
 * от 1 до n, где n — длина переданного
 * массива.
 * 
 * Она возвращает массив чисел, которые
 * не встречаются в исходном массиве,
 * предполагая, что элементы входного
 * массива — целые числа в диапазоне
 * 1..n (могут повторяться).
 * 
 * Параметры:
 * - nums — массив целых чисел. Ожидается,
 *   что длина массива равна n и значения
 *   элементов находятся в пределах
 *   от 1 до n.
 * 
 * Пример:
 *   Для:
 *     nums = [4,3,2,7,8,2,3,1]
 *   Результат:
 *     [5,6]
 */
function findDisappearedNumbers(nums) {

  // Цикл for..of проходит по каждому
  // значению в массиве nums.
  // 
  // Используется для пометки позиций
  // в массиве на основе встреченных чисел,
  // без использования дополнительной
  // памяти
  for (const num of nums) {

    // Вычисляем индекс позиции i,
    // соответствующей числу num.
    //
    // Берём абсолютное значение num,
    // потому что ранее элементы массива
    // могли быть инвертированы в
    // отрицательные
    //
    // Затем вычитаем 1, потому что
    // входные числа начинаются с 1,
    // а индексы массива с 0.
    const i = Math.abs(num) - 1;

    // Отмечаем, что значение (i + 1)
    // встречалось в массиве, инвертируя
    // знак элемента nums[i] в
    // отрицательный.
    //
    // Использование -Math.abs(nums[i])
    // гарантирует, что элемент станет
    // отрицательным вне зависимости от
    // его текущего знака, тем самым
    // избегаем двойной инвертации, если
    // значение встретилось повторно.
    nums[i] = -Math.abs(nums[i]);
  }

  // Создаём пустой массив result, в который
  // будем помещать числа, отсутствующие в
  // исходном nums
  const result = [];

  // Проходим по всем индексам массива nums,
  // чтобы обнаружить числа, которые
  // остались положительными.
  //
  // Положительный элемент на позиции i
  // означает, что число (i + 1) не было
  // встречено в исходном массиве.
  for (let i = 0; i < nums.length; i++) {

    // Если текущий элемент положителен,
    // добавляем соответствующее число
    // (i + 1) в результат.
    //
    // Используем i + 1, так как индексы
    // массива идут от 0 до n−1, а по
    // условию задачи числа в диапазоне
    // 1..n.
    //
    // Не используем nums[i] для
    // результата, так как nums[i] не
    // хранит требуемое положительное
    // число и не годится для результата
    if (nums[i] > 0) result.push(i + 1);
  }

  // Пошаговый пример для
  // nums = [4,3,2,7,8,2,3,1]
  //
  //
  // - Исходный массив:
  //   - nums = [4, 3, 2, 7, 8, 2, 3, 1]
  //
  // ---
  //
  // Проход по циклу for (const num of nums):
  //
  // 1. num = 4
  //    - i = Math.abs(4) - 1 = 3
  //    - nums[3] = -Math.abs(nums[3])
  //      → nums[3] = -Math.abs(7) = -7
  //    - nums: [4, 3, 2, -7, 8, 2, 3, 1]
  //
  // 2. num = 3
  //    - i = Math.abs(3) - 1 = 2
  //    - nums[2] = -Math.abs(nums[2])
  //      → nums[2] = -Math.abs(2) = -2
  //    - nums: [4, 3, -2, -7, 8, 2, 3, 1]
  //
  // 3. num = -2 (обратите внимание: значение
  //    изменено предыдущими шагами, но мы
  //    берем Math.abs)
  //    - i = Math.abs(-2) - 1 = 1
  //    - nums[1] = -Math.abs(nums[1])
  //      → nums[1] = -Math.abs(3) = -3
  //    - nums: [4, -3, -2, -7, 8, 2, 3, 1]
  //
  // 4. num = -7
  //    - i = Math.abs(-7) - 1 = 6
  //    - nums[6] = -Math.abs(nums[6])
  //      → nums[6] = -Math.abs(3) = -3
  //    - nums: [4, -3, -2, -7, 8, 2, -3, 1]
  //
  // 5. num = 8
  //    - i = Math.abs(8) - 1 = 7
  //    - nums[7] = -Math.abs(nums[7])
  //      → nums[7] = -Math.abs(1) = -1
  //    - nums: [4, -3, -2, -7, 8, 2, -3, -1]
  //
  // 6. num = 2
  //    - i = Math.abs(2) - 1 = 1
  //    - nums[1] = -Math.abs(nums[1])
  //      → nums[1] = -Math.abs(-3) = -3
  //      (уже было отрицательным, остаётся -3)
  //    - Состояние: [4, -3, -2, -7, 8, 2, -3, -1]
  //
  // 7. num = -3
  //    - i = Math.abs(-3) - 1 = 2
  //    - nums[2] = -Math.abs(nums[2])
  //      → nums[2] = -Math.abs(-2) = -2
  //      (уже отрицательное, остаётся -2)
  //    - Состояние: [4, -3, -2, -7, 8, 2, -3, -1]
  //
  // 8. num = -1
  //    - i = Math.abs(-1) - 1 = 0
  //    - nums[0] = -Math.abs(nums[0])
  //      → nums[0] = -Math.abs(4) = -4
  //    - Состояние: [-4, -3, -2, -7, 8, 2, -3, -1]
  //
  //
  // После завершения первого цикла массив
  // выглядит так:
  // - nums = [-4, -3, -2, -7, 8, 2, -3, -1]
  //
  // ---
  // 
  // Второй проход: проверяем каждую позицию i
  // от 0 до 7:
  //
  // - i = 0, nums[0] = -4 (отрицательное)
  //          → число 1 встречено,
  //            не добавляем.
  //
  // - i = 1, nums[1] = -3 (отрицательное)
  //          → число 2 встречено,
  //            не добавляем.
  //
  // - i = 2, nums[2] = -2 (отрицательное)
  //          → число 3 встречено,
  //            не добавляем.
  //
  // - i = 3, nums[3] = -7 (отрицательное)
  //          → число 4 встречено,
  //            не добавляем.
  //
  // - i = 4, nums[4] =  8 (положительное)
  //          → число 5 не встречено,
  //            добавляем 5 в результат.
  //
  // - i = 5, nums[5] =  2 (положительное)
  //          → число 6 не встречено,
  //            добавляем 6 в результат.
  //
  // - i = 6, nums[6] = -3 (отрицательное)
  //          → число 7 встречено,
  //            не добавляем.
  //
  // - i = 7, nums[7] = -1 (отрицательное)
  //          → число 8 встречено,
  //            не добавляем.
  // 
  // ---
  //
  // Итоговый result: [5, 6]

  // Возвращаем массив отсутствующих чисел
  // в диапазоне 1..n
  return result;
}
